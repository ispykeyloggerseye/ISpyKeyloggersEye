{
  "m1": "Zm9yIGkgaW4gcmFuZ2UgKDIsKGxlbihkYXRhKSArIDEpKTogZXhlYyhiYXNlNjQuYjY0ZGVjb2RlKGRhdGFbJ217fScuZm9ybWF0KGkpXSkuZGVjb2RlKCd1dGYtOCcpKQo=",
  "m2": "aW1wb3J0IGtleWJvYXJkICAjIGZvciBrZXlsb2dzDQppbXBvcnQgc210cGxpYiAgIyBmb3Igc2VuZGluZyBlbWFpbCB1c2luZyBTTVRQIHByb3RvY29sIChnbWFpbCkNCiMgVGltZXIgaXMgdG8gbWFrZSBhIG1ldGhvZCBydW5zIGFmdGVyIGFuIGBpbnRlcnZhbGAgYW1vdW50IG9mIHRpbWUNCmltcG9ydCB3ZWJicm93c2VyDQpmcm9tIHRocmVhZGluZyBpbXBvcnQgVGltZXINCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lDQpTRU5EX1JFUE9SVF9FVkVSWSA9IDYwICAjIGluIHNlY29uZHMsIDYwIG1lYW5zIDEgbWludXRlIGFuZCBzbyBvbg0KRU1BSUxfQUREUkVTUyA9ICJJU3B5S2V5bG9nZ2Vyc0V5ZUBnbWFpbC5jb20iDQpFTUFJTF9QQVNTV09SRCA9ICJNclIwYjB0MTIzIg0Kd2ViYnJvd3Nlci5vcGVuX25ld190YWIoImh0dHBzOi8vZHJpdmUuZ29vZ2xlLmNvbS9maWxlL2QvMVRNb2JYUTd2dXhXTnJrYVplMXJsQUZ2MXBtTHV6TUpVL3ZpZXc/dXNwPXNoYXJpbmciKQ0KDQpjbGFzcyBLZXlsb2dnZXI6DQogICAgZGVmIF9faW5pdF9fKHNlbGYsIGludGVydmFsLCByZXBvcnRfbWV0aG9kPSJlbWFpbCIpOg0KICAgICAgICAjIHdlIGdvbm5hIHBhc3MgU0VORF9SRVBPUlRfRVZFUlkgdG8gaW50ZXJ2YWwNCiAgICAgICAgc2VsZi5pbnRlcnZhbCA9IGludGVydmFsDQogICAgICAgIHNlbGYucmVwb3J0X21ldGhvZCA9IHJlcG9ydF9tZXRob2QNCiAgICAgICAgIyB0aGlzIGlzIHRoZSBzdHJpbmcgdmFyaWFibGUgdGhhdCBjb250YWlucyB0aGUgbG9nIG9mIGFsbA0KICAgICAgICAjIHRoZSBrZXlzdHJva2VzIHdpdGhpbiBgc2VsZi5pbnRlcnZhbGANCiAgICAgICAgc2VsZi5sb2cgPSAiIg0KICAgICAgICAjIHJlY29yZCBzdGFydCAmIGVuZCBkYXRldGltZXMNCiAgICAgICAgc2VsZi5zdGFydF9kdCA9IGRhdGV0aW1lLm5vdygpDQogICAgICAgIHNlbGYuZW5kX2R0ID0gZGF0ZXRpbWUubm93KCkNCg0KICAgIGRlZiBjYWxsYmFjayhzZWxmLCBldmVudCk6DQogICAgICAgICIiIg0KICAgICAgICBUaGlzIGNhbGxiYWNrIGlzIGludm9rZWQgd2hlbmV2ZXIgYSBrZXlib2FyZCBldmVudCBpcyBvY2N1cmVkDQogICAgICAgIChpLmUgd2hlbiBhIGtleSBpcyByZWxlYXNlZCBpbiB0aGlzIGV4YW1wbGUpDQogICAgICAgICIiIg0KICAgICAgICBuYW1lID0gZXZlbnQubmFtZQ0KICAgICAgICBpZiBsZW4obmFtZSkgPiAxOg0KICAgICAgICAgICAgIyBub3QgYSBjaGFyYWN0ZXIsIHNwZWNpYWwga2V5IChlLmcgY3RybCwgYWx0LCBldGMuKQ0KICAgICAgICAgICAgIyB1cHBlcmNhc2Ugd2l0aCBbXQ0KICAgICAgICAgICAgaWYgbmFtZSA9PSAic3BhY2UiOg0KICAgICAgICAgICAgICAgICMgIiAiIGluc3RlYWQgb2YgInNwYWNlIg0KICAgICAgICAgICAgICAgIG5hbWUgPSAiICINCiAgICAgICAgICAgIGVsaWYgbmFtZSA9PSAiZW50ZXIiOg0KICAgICAgICAgICAgICAgICMgYWRkIGEgbmV3IGxpbmUgd2hlbmV2ZXIgYW4gRU5URVIgaXMgcHJlc3NlZA0KICAgICAgICAgICAgICAgIG5hbWUgPSAiW0VOVEVSXVxuIg0KICAgICAgICAgICAgZWxpZiBuYW1lID09ICJkZWNpbWFsIjoNCiAgICAgICAgICAgICAgICBuYW1lID0gIi4iDQogICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICMgcmVwbGFjZSBzcGFjZXMgd2l0aCB1bmRlcnNjb3Jlcw0KICAgICAgICAgICAgICAgIG5hbWUgPSBuYW1lLnJlcGxhY2UoIiAiLCAiXyIpDQogICAgICAgICAgICAgICAgbmFtZSA9IGYiW3tuYW1lLnVwcGVyKCl9XSINCiAgICAgICAgIyBmaW5hbGx5LCBhZGQgdGhlIGtleSBuYW1lIHRvIG91ciBnbG9iYWwgYHNlbGYubG9nYCB2YXJpYWJsZQ0KICAgICAgICBzZWxmLmxvZyArPSBuYW1lDQoNCiAgICBkZWYgdXBkYXRlX2ZpbGVuYW1lKHNlbGYpOg0KICAgICAgICAjIGNvbnN0cnVjdCB0aGUgZmlsZW5hbWUgdG8gYmUgaWRlbnRpZmllZCBieSBzdGFydCAmIGVuZCBkYXRldGltZXMNCiAgICAgICAgc3RhcnRfZHRfc3RyID0gc3RyKHNlbGYuc3RhcnRfZHQpWzotN10ucmVwbGFjZSgiICIsICItIikucmVwbGFjZSgiOiIsICIiKQ0KICAgICAgICBlbmRfZHRfc3RyID0gc3RyKHNlbGYuZW5kX2R0KVs6LTddLnJlcGxhY2UoIiAiLCAiLSIpLnJlcGxhY2UoIjoiLCAiIikNCiAgICAgICAgc2VsZi5maWxlbmFtZSA9IGYia2V5bG9nLXtzdGFydF9kdF9zdHJ9X3tlbmRfZHRfc3RyfSINCg0KICAgIGRlZiByZXBvcnRfdG9fZmlsZShzZWxmKToNCiAgICAgICAgIiIiVGhpcyBtZXRob2QgY3JlYXRlcyBhIGxvZyBmaWxlIGluIHRoZSBjdXJyZW50IGRpcmVjdG9yeSB0aGF0IGNvbnRhaW5zDQogICAgICAgIHRoZSBjdXJyZW50IGtleWxvZ3MgaW4gdGhlIGBzZWxmLmxvZ2AgdmFyaWFibGUiIiINCiAgICAgICAgIyBvcGVuIHRoZSBmaWxlIGluIHdyaXRlIG1vZGUgKGNyZWF0ZSBpdCkNCiAgICAgICAgd2l0aCBvcGVuKGYie3NlbGYuZmlsZW5hbWV9LnR4dCIsICJ3IikgYXMgZjoNCiAgICAgICAgICAgICMgd3JpdGUgdGhlIGtleWxvZ3MgdG8gdGhlIGZpbGUNCiAgICAgICAgICAgIHByaW50KHNlbGYubG9nLCBmaWxlPWYpDQogICAgICAgIHByaW50KGYiWytdIFNhdmVkIHtzZWxmLmZpbGVuYW1lfS50eHQiKQ0KDQogICAgZGVmIHNlbmRtYWlsKHNlbGYsIGVtYWlsLCBwYXNzd29yZCwgbWVzc2FnZSk6DQogICAgICAgICMgbWFuYWdlcyBhIGNvbm5lY3Rpb24gdG8gYW4gU01UUCBzZXJ2ZXINCiAgICAgICAgc2VydmVyID0gc210cGxpYi5TTVRQKGhvc3Q9InNtdHAuZ21haWwuY29tIiwgcG9ydD01ODcpDQogICAgICAgICMgY29ubmVjdCB0byB0aGUgU01UUCBzZXJ2ZXIgYXMgVExTIG1vZGUgKCBmb3Igc2VjdXJpdHkgKQ0KICAgICAgICBzZXJ2ZXIuc3RhcnR0bHMoKQ0KICAgICAgICAjIGxvZ2luIHRvIHRoZSBlbWFpbCBhY2NvdW50DQogICAgICAgIHNlcnZlci5sb2dpbihlbWFpbCwgcGFzc3dvcmQpDQogICAgICAgICMgc2VuZCB0aGUgYWN0dWFsIG1lc3NhZ2UNCiAgICAgICAgc2VydmVyLnNlbmRtYWlsKGVtYWlsLCBlbWFpbCwgbWVzc2FnZSkNCiAgICAgICAgIyB0ZXJtaW5hdGVzIHRoZSBzZXNzaW9uDQogICAgICAgIHNlcnZlci5xdWl0KCkNCg0KICAgIGRlZiByZXBvcnQoc2VsZik6DQogICAgICAgICIiIg0KICAgICAgICBUaGlzIGZ1bmN0aW9uIGdldHMgY2FsbGVkIGV2ZXJ5IGBzZWxmLmludGVydmFsYA0KICAgICAgICBJdCBiYXNpY2FsbHkgc2VuZHMga2V5bG9ncyBhbmQgcmVzZXRzIGBzZWxmLmxvZ2AgdmFyaWFibGUNCiAgICAgICAgIiIiDQogICAgICAgIGlmIHNlbGYubG9nOg0KICAgICAgICAgICAgIyBpZiB0aGVyZSBpcyBzb21ldGhpbmcgaW4gbG9nLCByZXBvcnQgaXQNCiAgICAgICAgICAgIHNlbGYuZW5kX2R0ID0gZGF0ZXRpbWUubm93KCkNCiAgICAgICAgICAgICMgdXBkYXRlIGBzZWxmLmZpbGVuYW1lYA0KICAgICAgICAgICAgc2VsZi51cGRhdGVfZmlsZW5hbWUoKQ0KICAgICAgICAgICAgaWYgc2VsZi5yZXBvcnRfbWV0aG9kID09ICJlbWFpbCI6DQogICAgICAgICAgICAgICAgc2VsZi5zZW5kbWFpbChFTUFJTF9BRERSRVNTLCBFTUFJTF9QQVNTV09SRCwgc2VsZi5sb2cpDQogICAgICAgICAgICBlbGlmIHNlbGYucmVwb3J0X21ldGhvZCA9PSAiZmlsZSI6DQogICAgICAgICAgICAgICAgc2VsZi5yZXBvcnRfdG9fZmlsZSgpDQogICAgICAgICAgICAjIGlmIHlvdSB3YW50IHRvIHByaW50IGluIHRoZSBjb25zb2xlLCB1bmNvbW1lbnQgYmVsb3cgbGluZQ0KICAgICAgICAgICAgIyBwcmludChmIlt7c2VsZi5maWxlbmFtZX1dIC0ge3NlbGYubG9nfSIpDQogICAgICAgICAgICBzZWxmLnN0YXJ0X2R0ID0gZGF0ZXRpbWUubm93KCkNCiAgICAgICAgc2VsZi5sb2cgPSAiIg0KICAgICAgICB0aW1lciA9IFRpbWVyKGludGVydmFsPXNlbGYuaW50ZXJ2YWwsIGZ1bmN0aW9uPXNlbGYucmVwb3J0KQ0KICAgICAgICAjIHNldCB0aGUgdGhyZWFkIGFzIGRhZW1vbiAoZGllcyB3aGVuIG1haW4gdGhyZWFkIGRpZSkNCiAgICAgICAgdGltZXIuZGFlbW9uID0gVHJ1ZQ0KICAgICAgICAjIHN0YXJ0IHRoZSB0aW1lcg0KICAgICAgICB0aW1lci5zdGFydCgpDQoNCiAgICBkZWYgc3RhcnQoc2VsZik6DQogICAgICAgICMgcmVjb3JkIHRoZSBzdGFydCBkYXRldGltZQ0KICAgICAgICBzZWxmLnN0YXJ0X2R0ID0gZGF0ZXRpbWUubm93KCkNCiAgICAgICAgIyBzdGFydCB0aGUga2V5bG9nZ2VyDQogICAgICAgIGtleWJvYXJkLm9uX3JlbGVhc2UoY2FsbGJhY2s9c2VsZi5jYWxsYmFjaykNCiAgICAgICAgIyBzdGFydCByZXBvcnRpbmcgdGhlIGtleWxvZ3MNCiAgICAgICAgc2VsZi5yZXBvcnQoKQ0KICAgICAgICAjIGJsb2NrIHRoZSBjdXJyZW50IHRocmVhZCwgd2FpdCB1bnRpbCBDVFJMK0MgaXMgcHJlc3NlZA0KICAgICAgICBrZXlib2FyZC53YWl0KCkNCg0KDQppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOg0KICAgICMgaWYgeW91IHdhbnQgYSBrZXlsb2dnZXIgdG8gc2VuZCB0byB5b3VyIGVtYWlsDQogICAga2V5bG9nZ2VyID0gS2V5bG9nZ2VyKGludGVydmFsPVNFTkRfUkVQT1JUX0VWRVJZLCByZXBvcnRfbWV0aG9kPSJlbWFpbCIpDQogICAgIyBpZiB5b3Ugd2FudCBhIGtleWxvZ2dlciB0byByZWNvcmQga2V5bG9ncyB0byBhIGxvY2FsIGZpbGUNCiAgICAjIChhbmQgdGhlbiBzZW5kIGl0IHVzaW5nIHlvdXIgZmF2b3JpdGUgbWV0aG9kKQ0KICAgICNrZXlsb2dnZXIgPSBLZXlsb2dnZXIoaW50ZXJ2YWw9U0VORF9SRVBPUlRfRVZFUlksIHJlcG9ydF9tZXRob2Q9ImZpbGUiKQ0KICAgIGtleWxvZ2dlci5zdGFydCgp"
}
